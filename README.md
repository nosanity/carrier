
# Описание

Микросервис, предназначенный для чтения, записи и доставки сообщений от Kafka любым приложениям по протоколу HTTP.

Используемый стек: ```python3.7```, ```aiohttp3.4```

# Установка

1. Создать и активировать виртуальную среду

    ```$ virtualenv -p python3.7 venv```
    ```$ source venv/bin/activate```

2. Установить зависимости
    ```$ pip install -r requirements.txt```

3. Задать настройки приложения
	
	**Раздел будет существенно переработан.**
	
    В папке ```config``` находятся заготовка ```dev.yaml.example```. Для локального запуска необходимо создать файл dev.yaml и задать требуемые параметры. 

Секция ```kafka``` содержит параметры ```host``` и ```port```, где необходимо указать хост и порт брокера Kafka, а также параметр ```topic``` - топик, сообщения которого будут "слушаться" и "читаться".  **В дальнейшем будет добавлена возможность задать несколько топиков.** 

Секция ```client``` содержит параметры ```host```, ```port```, и ```protocol```, где задаются параметра клиента (приложения), которое будет получать и отправлять сообщения, а также ```url``` - callback url, на которой будут отправляться приходящие сообщения. 
**В дальнейшем будет добавлена возможность задать несколько клиентов.** 

Параметры внизу файла конфигурации ```host``` и ```port``` отвечают за хост и порт самого приложения.

# Запуск приложения

Приложение можно запускать в двух различных вариантов, а именно:

- С помощью встроенного сервера

    ```$ python run.py --config=<config_name> ```
    Параметр ```--config``` можно пропустить, в таком случае по-умолчанию будет использован файл ```config/dev.yaml```

- С помощью Gunicorn

    ```$ gunicorn 'app.main:wsgi("<config_name>")' -b 0.0.0.0:<port> -k aiohttp.GunicornWebWorker -w <workers>```,  где ```<config_name>``` - имя конфигурационного файла (**внимание**, в данном способе запуска указывать кофнигурационный файл обязательно, по-умолчанию значение не подставляется), ```<port>``` - TCP-порт, по которому будет доступно приложение, ```<workers>``` - количество "воркеров".
